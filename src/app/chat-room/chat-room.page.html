<ion-header>
  <ion-toolbar color="connectheader">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="home"  text="" color="medium"></ion-back-button>
    </ion-buttons>
    <ion-title>
      Chat
    </ion-title>
  </ion-toolbar>
</ion-header>
<ion-content color="light">
<!--   <ion-grid>
    <ion-row *ngFor="let message of messages">
      
      <ion-col col-9 *ngIf="message.from !== nickname" class="message" [ngClass]="{'my_message': message.from === nickname, 'other_message': message.from !== nickname}">
        <span class="user_name">{{ message.from }}:</span><br>
        <span>{{ message.text }}</span>
        <div class="time">{{message.created | date:'dd.MM hh:MM'}}</div>
      </ion-col>
  
<ion-content>
  <ion-grid>
    <ion-row *ngFor="let message of messages">
      
      <ion-col col-9 *ngIf="message.from !== nickname" class="message" [ngClass]="{'my_message': message.from === nickname, 'other_message': message.from !== nickname}">
        <span class="user_name">{{ message.from }}:</span><br>
        <span>{{ message.text }}</span>
        <div class="time">{{message.created | date:'dd.MM hh:MM'}}</div>
      </ion-col>
 
      <ion-col offset-3 col-9 *ngIf="message.from === nickname" class="message" [ngClass]="{'my_message': message.from === nickname, 'other_message': message.from !== nickname}">
        <span class="user_name">{{ message.from }}:</span><br>
        <span>{{ message.text }}</span>
        <div class="time">{{message.created | date:'dd.MM hh:MM'}}</div>
      </ion-col>
 
    </ion-row>
  </ion-grid>
 
</ion-content>
 
      <ion-col offset-3 col-9 *ngIf="message.from === nickname" class="message" [ngClass]="{'my_message': message.from === nickname, 'other_message': message.from !== nickname}">
        <span class="user_name">{{ message.from }}:</span><br>
        <span>{{ message.text }}</span>
        <div class="time">{{message.created | date:'dd.MM hh:MM'}}</div>
      </ion-col>
 
    </ion-row>
  </ion-grid>
 --> 
 
      <!-- <ion-col size="9" *ngIf="message.senderId !== currentUser" class="message other-message">
        <b>{{ message.user }}</b><br>
        <span>{{ message.message }}</span>
        <div class="time ion-text-right" ><br>{{ message.createdAt | date:'short' }}</div>
      </ion-col>
 
      <ion-col offset="3" size="9" *ngIf="message.senderId === currentUser" class="message my-message">
        <b>{{ message.user }}</b><br>
        <span>{{ message.message }}</span>
        <div class="time ion-text-right" ><br>{{ message.createdAt | date:'short' }}</div>
      </ion-col> -->
 
 <!--    <ion-list class="chat-list" lines="none">

        <ion-item *ngFor="let message of messages" class="message" [class.ion-text-left]=" message.senderId !== currentUser" [class.ion-text-right]="message.senderId === currentUser">
                  <div class="chat-bubble">
                    <div class="msg-info">
                      <p>
                        {{message.createdAt | date:'short'}}</p>
                    </div>
                    <div class="msg-content">
                      <span class="triangle"></span>
                      <p class="chat-message ">{{message.message}}</p>
                    </div>
                  </div>
        </ion-item>

    </ion-list>
 -->
 
  <ion-grid>
    <ion-row *ngFor="let message of messages;let i = index;">
      <ion-col class="ion-text-center" *ngIf="messages[i-1] && (message.createdAt| date:'EEEE d MMMM')!=(messages[i-1].createdAt| date:'EEEE d MMMM')" size=12>
        <div class="date">{{(today | date:'EEEE d MMMM')=== (message.createdAt |date:'EEEE d MMMM')?'Today':message.createdAt | date:'MMM d, y'}}</div>
      </ion-col>
      <ion-col [offset]="message.senderId === currentUser?'3':''" size="9" class="message" [ngClass]="{'my_message': message.senderId === currentUser, 'other_message': message.senderId !== currentUser,'message-arrow':(messages[i-1] && message.senderId !== messages[i-1].senderId)}">
        <span>{{ message.message }}</span>
        <div class="time">{{message.createdAt | date:'hh:MM a'}}</div>
      </ion-col>
 
    </ion-row>
  </ion-grid>
 
 
 
</ion-content>
 
<ion-footer>
  <ion-toolbar>
    <ion-row class="message_row">
      <ion-col size="10">
        <ion-item no-lines>
          <ion-input type="text" placeholder="Message" [(ngModel)]="message"></ion-input>
        </ion-item>
      </ion-col>
      <ion-col size="2">
        <ion-button clear expand="block" fill="clear" color="primary" (click)="sendMessage()" [disabled]="message === ''">Send</ion-button>
      </ion-col>
    </ion-row>
  </ion-toolbar>
</ion-footer>